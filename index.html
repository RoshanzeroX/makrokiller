<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>р╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Ир╕▒р╕Фр╕кр╕┤р╕Щр╕Др╣Йр╕▓ by Suneii</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="background"></div>
    <div class="content-wrapper fade-slide-in">
        <main>
            <h1 class="title-no-wrap">тЬи р╕вр╕┤р╕Щр╕Фр╕╡р╕Хр╣Йр╕нр╕Щр╕гр╕▒р╕Ър╕кр╕╣р╣Ир╣Вр╕Ыр╕гр╣Бр╕Бр╕гр╕бр╕Ир╕▒р╕Фр╕кр╕┤р╕Щр╕Др╣Йр╕▓ тЬи</h1>
            
            <input type="number" id="dailyGoalInput" placeholder="р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в SKU/р╕зр╕▒р╕Щ">
            <input type="number" id="muGoalInput" placeholder="р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в MU/р╕зр╕▒р╕Щ">
            <button id="calculateButton">ЁЯУК р╕Др╕│р╕Щр╕зр╕У</button>
            
            <div class="info-card photo-card" style="margin-top: 2em;">
                <h2>ЁЯУ╕ р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ыр╕гр╕░р╕Ир╕│р╕зр╕▒р╕Щ</h2>
                <div id="photoPreviewContainer" style="display: none;">
                    <img id="dailyPhotoPreview" alt="р╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Ыр╕гр╕░р╕Ир╕│р╕зр╕▒р╕Щ" style="max-width: 100%; height: auto; border-radius: 10px; margin-top: 15px; border: 2px solid rgba(255, 255, 255, 0.5);">
                    <button id="clearPhotoButton" class="clear-button" style="margin-top: 15px;">ЁЯЧСя╕П р╕ер╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Ю</button>
                </div>
            </div>

        </main>

        <footer>
            <p>ЁЯТЦ р╕Вр╕нр╣Гр╕лр╣Йр╕Ир╕▒р╕Фр╕Вр╕нр╕Зр╣Др╕Фр╣Йр╣Ар╕вр╕нр╕░р╣Ж р╕вр╕нр╕Фр╕Ыр╕▒р╕Зр╣Ж р╕Др╕гр╕▒р╕Ъ! ЁЯТЦ</p>
            <p>р╕кр╕гр╣Йр╕▓р╕Зр╕кр╕гр╕гр╕Др╣Мр╣Вр╕Фр╕в Suneii Dev.</p>
        </footer>
    </div>

    <button id="duckButton" class="floating-button" aria-label="р╣Др╕Ыр╕лр╕Щр╣Йр╕▓р╣Ар╕Ыр╣Зр╕Ф">ЁЯжЖ</button>
    <button id="cameraButton" class="floating-button" aria-label="р╕Цр╣Ир╕▓р╕вр╕гр╕╣р╕Ы">ЁЯУ╕</button>
    <button id="fullscreenButton" class="floating-button" aria-label="р╣Ар╕Ыр╕┤р╕Ф/р╕Ыр╕┤р╕Фр╣Ар╕Хр╣Зр╕бр╕Ир╕н">ЁЯУ▒</button>
    <button id="dailyAverageButton" class="floating-button" aria-label="р╣Др╕Ыр╕лр╕Щр╣Йр╕▓р╕Др╣Ир╕▓р╣Ар╕Йр╕ер╕╡р╣Ир╕в">ЁЯТ░</button>

    <input type="file" id="photoInput" accept="image/*" capture="environment" style="display: none;">

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const dailyGoalInput = document.getElementById('dailyGoalInput');
            const muGoalInput = document.getElementById('muGoalInput');
            const calculateButton = document.getElementById('calculateButton');
            const duckButton = document.getElementById('duckButton');
            const fullscreenButton = document.getElementById('fullscreenButton');
            const dailyAverageButton = document.getElementById('dailyAverageButton');
            
            // р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Цр╣Ир╕▓р╕вр╕гр╕╣р╕Ыр╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Index
            const photoInput = document.getElementById('photoInput');
            const cameraButton = document.getElementById('cameraButton');
            const dailyPhotoPreview = document.getElementById('dailyPhotoPreview');
            const photoPreviewContainer = document.getElementById('photoPreviewContainer');
            const clearPhotoButton = document.getElementById('clearPhotoButton');


            // р╣Вр╕лр╕ер╕Фр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Др╕зр╣Йр╣Гр╕Щ Local Storage (р╣Ар╕Ыр╣Йр╕▓р╕лр╕бр╕▓р╕в SKU/MU)
            const savedSkuGoal = localStorage.getItem('skuDailyGoal');
            const savedMuGoal = localStorage.getItem('muDailyGoal');

            if (savedSkuGoal) {
                dailyGoalInput.value = savedSkuGoal;
            }
            if (savedMuGoal) {
                muGoalInput.value = savedMuGoal;
            }

            calculateButton.addEventListener('click', () => {
                const skuDaily = dailyGoalInput.value;
                const muDaily = muGoalInput.value;

                // р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Др╣Ир╕▓р╕ер╕З Local Storage
                localStorage.setItem('skuDailyGoal', skuDaily);
                localStorage.setItem('muDailyGoal', muDaily);

                // р╕кр╣Ир╕Зр╕Др╣Ир╕▓р╣Др╕Ыр╕вр╕▒р╕З daily_average.html
                window.location.href = `daily_average.html?skuDaily=${skuDaily}&muDaily=${muDaily}`;
            });

            // --- р╕кр╣Ир╕зр╕Щр╕Вр╕нр╕Зр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Цр╣Ир╕▓р╕вр╕гр╕╣р╕Ыр╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Index ---

            // р╣Вр╕лр╕ер╕Фр╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╣Др╕зр╣Йр╣Гр╕Щ Local Storage р╕Хр╕нр╕Щр╣Вр╕лр╕ер╕Фр╕лр╕Щр╣Йр╕▓
            const savedPhotoDataUrl = localStorage.getItem('dailyPhotoIndex'); // р╣Гр╕Кр╣Й key р╣Бр╕вр╕Бр╕Бр╕▒р╕Щр╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕╣р╕Ыр╣Гр╕Щр╕лр╕Щр╣Йр╕▓ index
            if (savedPhotoDataUrl) {
                dailyPhotoPreview.src = savedPhotoDataUrl;
                photoPreviewContainer.style.display = 'block';
            }

            // р╣Ар╕бр╕╖р╣Ир╕нр╕Бр╕Фр╕Ыр╕╕р╣Ир╕бр╕Бр╕ер╣Йр╕нр╕З (Floating Button) р╣Гр╕лр╣Йр╕Др╕ер╕┤р╕Б input type="file" р╕Чр╕╡р╣Ир╕Лр╣Ир╕нр╕Щр╣Др╕зр╣Й
            cameraButton.addEventListener('click', () => {
                photoInput.click();
            });

            // р╣Ар╕бр╕╖р╣Ир╕нр╣Ар╕ер╕╖р╕нр╕Бр╣Др╕Яр╕ер╣Мр╕гр╕╣р╕Ыр╕ар╕▓р╕Ю (р╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Цр╣Ир╕▓р╕вр╕лр╕гр╕╖р╕нр╣Ар╕ер╕╖р╕нр╕Бр╣Гр╕Щр╣Ар╕Др╕гр╕╖р╣Ир╕нр╕З)
            photoInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageDataUrl = e.target.result;
                        dailyPhotoPreview.src = imageDataUrl;
                        photoPreviewContainer.style.display = 'block';
                        localStorage.setItem('dailyPhotoIndex', imageDataUrl); // р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕гр╕╣р╕Ыр╣Гр╕лр╕бр╣Ир╕Чр╕▒р╕Ър╕Вр╕нр╕Зр╣Ар╕Бр╣Ир╕▓
                    };
                    reader.readAsDataURL(file); // р╕нр╣Ир╕▓р╕Щр╣Др╕Яр╕ер╣Мр╣Ар╕Ыр╣Зр╕Щ Data URL
                }
            });

            // р╕Ыр╕╕р╣Ир╕бр╕ер╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Ю
            clearPhotoButton.addEventListener('click', () => {
                dailyPhotoPreview.src = '';
                photoPreviewContainer.style.display = 'none';
                localStorage.removeItem('dailyPhotoIndex'); // р╕ер╕Ър╕гр╕╣р╕Ыр╕ар╕▓р╕Юр╕нр╕нр╕Бр╕Ир╕▓р╕Б Local Storage
            });

            // --- р╕кр╕┤р╣Йр╕Щр╕кр╕╕р╕Фр╕кр╣Ир╕зр╕Щр╕Вр╕нр╕Зр╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕Цр╣Ир╕▓р╕вр╕гр╕╣р╕Ы ---

            duckButton.addEventListener('click', () => {
                window.location.href = "songs.html";
            });

            fullscreenButton.addEventListener('click', () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch((err) => {
                        console.error(`р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Ар╕Ыр╕┤р╕Фр╣Вр╕лр╕бр╕Фр╣Ар╕Хр╣Зр╕бр╕Ир╕нр╣Др╕Фр╣Й: ${err.message}`);
                    });
                } else {
                    document.exitFullscreen();
                }
            });

            dailyAverageButton.addEventListener('click', () => {
                const skuDaily = dailyGoalInput.value;
                const muDaily = muGoalInput.value;
                window.location.href = `daily_average.html?skuDaily=${skuDaily}&muDaily=${muDaily}`;
            });
        });
    </script>
</body>
</html>
